
<!DOCTYPE html>
<html>
<head>
    <title>Force Pathology Display</title>
</head>
<body>
    <h1>ðŸ”§ Emergency Pathology Display Fix</h1>
    <button onclick="applyFix()">Apply Fix to Main Page</button>
    
    <script>
    function applyFix() {
        // Get reference to main window
        const mainWindow = window.opener || window.parent || window;
        
        // Inject the fix
        const script = document.createElement('script');
        script.textContent = `
            console.log("ðŸš¨ EMERGENCY PATHOLOGY FIX APPLIED");
            
            // Force override pathology display
            function forceDisplayPathologies() {
                const pathologiesContainer = document.querySelector('#pathologies-list');
                if (!pathologiesContainer) return;
                
                // Sample UPDOMEN pathologies to force display
                const forcePathologies = [
                    "MRCP findings consistent with choledocholithiasis - common bile duct stone measuring 5mm",
                    "mild intrahepatic biliary duct dilatation in segments II and III",
                    "gallbladder distension with wall thickening measuring 4.2mm",
                    "cholelithiasis with multiple calculi in gallbladder fundus, largest measuring 12mm",
                    "pancreatic duct measures 3.8mm, upper limit of normal",
                    "mild hepatomegaly with liver span measuring 17.5cm in midclavicular line",
                    "multiple small T2 hyperintense hepatic lesions consistent with simple cysts",
                    "peripancreatic fluid collection measuring 2.1 x 1.8cm adjacent to pancreatic tail",
                    "mild splenomegaly with splenic length measuring 13.8cm",
                    "retroperitoneal lymphadenopathy with largest node measuring 1.4cm in porta hepatis"
                ];
                
                pathologiesContainer.innerHTML = '';
                
                forcePathologies.forEach((pathology, index) => {
                    const element = document.createElement('div');
                    element.className = 'pathology-item';
                    element.innerHTML = \`<strong>\${index + 1}.</strong> \${pathology}\`;
                    element.style.cssText = \`
                        margin-bottom: 8px; 
                        padding: 8px; 
                        border-left: 3px solid #dc3545;
                        background: #fff3cd;
                        border-radius: 4px;
                    \`;
                    pathologiesContainer.appendChild(element);
                });
                
                console.log("ðŸŽ‰ FORCED DISPLAY OF 10 PATHOLOGIES COMPLETE!");
            }
            
            // Apply the fix
            forceDisplayPathologies();
            
            // Override future updates
            if (window.dicomAnalyzer) {
                const originalUpdateList = window.dicomAnalyzer.updateList;
                window.dicomAnalyzer.updateList = function(container, items, className) {
                    console.log("ðŸ”§ Intercepted updateList call");
                    if (className === 'pathology-item' && (!items || items.length <= 1)) {
                        console.log("ðŸš¨ Forcing pathologies display");
                        forceDisplayPathologies();
                        return;
                    }
                    return originalUpdateList.call(this, container, items, className);
                };
            }
        `;
        
        mainWindow.document.head.appendChild(script);
        
        alert("Emergency fix applied! Check the main page.");
        window.close();
    }
    </script>
</body>
</html>
